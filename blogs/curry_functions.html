<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>函数柯里化(Curry in JS) | Nicolas</title>
    <meta name="description" content="Winter is coming...">
    <link rel="icon" href="/nicolas_blog/logo.jpg">
  <link rel="manifest" href="/nicolas_blog/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/nicolas_blog/assets/css/0.styles.702c3d49.css" as="style"><link rel="preload" href="/nicolas_blog/assets/js/app.8757db7b.js" as="script"><link rel="preload" href="/nicolas_blog/assets/js/9.6edef93c.js" as="script"><link rel="prefetch" href="/nicolas_blog/assets/js/10.12fec6a4.js"><link rel="prefetch" href="/nicolas_blog/assets/js/2.46a28983.js"><link rel="prefetch" href="/nicolas_blog/assets/js/3.beca16df.js"><link rel="prefetch" href="/nicolas_blog/assets/js/4.1718758b.js"><link rel="prefetch" href="/nicolas_blog/assets/js/5.eac66c5d.js"><link rel="prefetch" href="/nicolas_blog/assets/js/6.af070ff6.js"><link rel="prefetch" href="/nicolas_blog/assets/js/7.d05c8e52.js"><link rel="prefetch" href="/nicolas_blog/assets/js/8.40f75c88.js"><link rel="prefetch" href="/nicolas_blog/assets/js/11.b0b60609.js"><link rel="prefetch" href="/nicolas_blog/assets/js/12.56bcea60.js"><link rel="prefetch" href="/nicolas_blog/assets/js/13.dbc3f0c5.js"><link rel="prefetch" href="/nicolas_blog/assets/js/14.4268a1c1.js"><link rel="prefetch" href="/nicolas_blog/assets/js/15.a82b5d46.js"><link rel="prefetch" href="/nicolas_blog/assets/js/16.6845d2c0.js"><link rel="prefetch" href="/nicolas_blog/assets/js/17.280974b2.js"><link rel="prefetch" href="/nicolas_blog/assets/js/18.3efbe42a.js"><link rel="prefetch" href="/nicolas_blog/assets/js/19.b2cfa31b.js"><link rel="prefetch" href="/nicolas_blog/assets/js/20.6150cfce.js"><link rel="prefetch" href="/nicolas_blog/assets/js/21.d6e364bc.js"><link rel="prefetch" href="/nicolas_blog/assets/js/22.8b69b201.js"><link rel="prefetch" href="/nicolas_blog/assets/js/23.3b3e70eb.js"><link rel="prefetch" href="/nicolas_blog/assets/js/24.ae14d3b9.js"><link rel="prefetch" href="/nicolas_blog/assets/js/25.8bd460fb.js"><link rel="prefetch" href="/nicolas_blog/assets/js/26.6431c747.js"><link rel="prefetch" href="/nicolas_blog/assets/js/27.28609ca5.js"><link rel="prefetch" href="/nicolas_blog/assets/js/28.069623ca.js"><link rel="prefetch" href="/nicolas_blog/assets/js/29.a95ca43d.js"><link rel="prefetch" href="/nicolas_blog/assets/js/30.1c0e0d8c.js">
    <link rel="stylesheet" href="/nicolas_blog/assets/css/0.styles.702c3d49.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nicolas_blog/" class="home-link router-link-active"><!----> <span class="site-name">Nicolas</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nicolas_blog/docs/" class="nav-link">My Cheatsheets</a></div><div class="nav-item"><a href="/nicolas_blog/blogs/" class="nav-link router-link-active">My Blog</a></div><div class="nav-item"><a href="/nicolas_blog/about/" class="nav-link">About Me</a></div> <a href="https://github.com/webkws" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nicolas_blog/docs/" class="nav-link">My Cheatsheets</a></div><div class="nav-item"><a href="/nicolas_blog/blogs/" class="nav-link router-link-active">My Blog</a></div><div class="nav-item"><a href="/nicolas_blog/about/" class="nav-link">About Me</a></div> <a href="https://github.com/webkws" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="carbon-ads"></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>My Blog</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/nicolas_blog/blogs/" class="sidebar-link">Vue Plugin实战</a></li><li><a href="/nicolas_blog/blogs/web_optimization.html" class="sidebar-link">Web性能优化</a></li><li><a href="/nicolas_blog/blogs/issues.html" class="sidebar-link">遇到过的Issue</a></li><li><a href="/nicolas_blog/blogs/curry_functions.html" class="active sidebar-link">函数柯里化(Curry in JS)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nicolas_blog/blogs/curry_functions.html#curry" class="sidebar-link">Curry</a></li><li class="sidebar-sub-header"><a href="/nicolas_blog/blogs/curry_functions.html#pipe和compose" class="sidebar-link">pipe和compose</a></li></ul></li><li><a href="/nicolas_blog/blogs/safe_access.html" class="sidebar-link">前端中的Robust</a></li><li><a href="/nicolas_blog/blogs/canvas.html" class="sidebar-link">Canvas学习笔记</a></li><li><a href="/nicolas_blog/blogs/js_optimization.html" class="sidebar-link">js优化(只谈写法)</a></li><li><a href="/nicolas_blog/blogs/data_structures.html" class="sidebar-link">数据结构和算法</a></li><li><a href="/nicolas_blog/blogs/mobile_unit.html" class="sidebar-link">Mobile中的单位问题</a></li><li><a href="/nicolas_blog/blogs/sentry.html" class="sidebar-link">Sentry前端部署扩展</a></li><li><a href="/nicolas_blog/blogs/oocss.html" class="sidebar-link">Object-Oriented CSS</a></li><li><a href="/nicolas_blog/blogs/vue_inject.html" class="sidebar-link">Vue中的奇淫技巧</a></li><li><a href="/nicolas_blog/blogs/es6_tips.html" class="sidebar-link">ES6/ES7 Best Practice</a></li><li><a href="/nicolas_blog/blogs/sass.html" class="sidebar-link">只会嵌套不敢说自己会SASS</a></li><li><a href="/nicolas_blog/blogs/vue_watch.html" class="sidebar-link">如何在vue中remove一个watcher</a></li><li><a href="/nicolas_blog/blogs/webpack.html" class="sidebar-link">由 CommonsChunk 到 SplitChunk</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="函数柯里化-curry-in-js"><a href="#函数柯里化-curry-in-js" aria-hidden="true" class="header-anchor">#</a> 函数柯里化(Curry in JS)</h1> <p>最近接触了<a href="http://www.ruanyifeng.com/blog/2012/04/functional_programming.html" target="_blank" rel="noopener noreferrer">函数式编程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，学会了柯里化，简单做个笔记，加深印象。</p> <p>Curry的概念很简单，就是通过传入一个参数就可以呼叫一个function去处理剩下的参数，可以一次性的呼叫<code>Curry function</code>,也可以每次只传一个参数。起到了<code>延迟计算</code>、<code>参数复用</code>、<code>动态生成函数</code>的作用。</p> <p>Youtube里一个视频这样总结的: <code>Curry is when a function doesn't take all of its arguments upfront instead, it wants you to give it the first argument and then the function returns another function which you are supposed to call with the second argument and so on untill all arguments have been provided and then the function at the end of the chain will be the one that returns the value you actually want</code></p> <h2 id="curry"><a href="#curry" aria-hidden="true" class="header-anchor">#</a> Curry</h2> <p>先看一下<a href="https://developer.mozilla.org/en-US/docs/Glossary/First-class_Function" target="_blank" rel="noopener noreferrer">First-class function的概念<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，简单来说就是<code>treated like any other variable</code>,这里是可以作为参数传递的例子.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">someFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello wolrd'</span><span class="token punctuation">)</span>
<span class="token comment">//第1种方式</span>
<span class="token keyword">const</span> <span class="token function-variable function">firstClass1</span> <span class="token operator">=</span> func <span class="token operator">=&gt;</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">firstClass1</span><span class="token punctuation">(</span>someFunction<span class="token punctuation">)</span><span class="token comment">// 'hello wolrd'</span>

<span class="token comment">//第2种方式</span>
<span class="token keyword">const</span> <span class="token function-variable function">firstClass2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> someFunction
<span class="token function">firstClass1</span><span class="token punctuation">(</span><span class="token function">firstClass2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//'hello wolrd'</span>
</code></pre></div><p>来个简单的例子看一下<code>curry</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//古老的add方法</span>
<span class="token keyword">const</span> <span class="token function-variable function">notCurry</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token comment">//es6书写的curry function</span>
<span class="token keyword">const</span> <span class="token function-variable function">curry</span> <span class="token operator">=</span> x <span class="token operator">=&gt;</span> y <span class="token operator">=&gt;</span> z <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y <span class="token operator">+</span> z<span class="token punctuation">;</span>
<span class="token comment">//可以这样使用</span>
<span class="token keyword">const</span> iKnowTwoParams <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//上边一行 相当于把参数固化了,返回了   z =&gt; 1 + 2 + z 这个函数 就等着最后一个z了</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">iKnowTwoParams</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 6</span>
</code></pre></div><p>用马冬梅来个更深刻的固化参数例子</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">whatName</span> <span class="token operator">=</span> a <span class="token operator">=&gt;</span> b <span class="token operator">=&gt;</span> c <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c
<span class="token keyword">const</span> mFunc <span class="token operator">=</span> <span class="token function">whatName</span><span class="token punctuation">(</span><span class="token string">'马'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> mdFunc <span class="token operator">=</span>  <span class="token function">mFunc</span><span class="token punctuation">(</span><span class="token string">'冬'</span><span class="token punctuation">)</span>
<span class="token comment">//马冬梅</span>
<span class="token keyword">const</span> mdm <span class="token operator">=</span> <span class="token function">mdFunc</span><span class="token punctuation">(</span><span class="token string">'梅'</span><span class="token punctuation">)</span>
</code></pre></div><p>类似的关于字符串<code>substr</code>的如下:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//古老的substr的写法</span>
<span class="token keyword">const</span> <span class="token function-variable function">iWantSubStr</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">,</span> start<span class="token punctuation">,</span> length<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> length<span class="token punctuation">)</span>
<span class="token comment">//下面改为curry</span>
<span class="token keyword">const</span> <span class="token function-variable function">curriedSubstr</span> <span class="token operator">=</span> start <span class="token operator">=&gt;</span> length <span class="token operator">=&gt;</span> str <span class="token operator">=&gt;</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//然后使用</span>
<span class="token keyword">const</span> <span class="token function-variable function">getSubstring</span> <span class="token operator">=</span> <span class="token punctuation">(</span>start<span class="token punctuation">,</span> length<span class="token punctuation">,</span> str<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">curriedSubstr</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//get第一个单词</span>
<span class="token keyword">const</span> <span class="token function-variable function">getFirstCharacters</span> <span class="token operator">=</span> <span class="token punctuation">(</span>length<span class="token punctuation">,</span> str<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">curriedSubstr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//get第一个字母</span>
<span class="token keyword">const</span> <span class="token function-variable function">getFirstCharacter</span> <span class="token operator">=</span> str <span class="token operator">=&gt;</span> <span class="token function">curriedSubstr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>用<code>lodash</code>的<code>curry</code>方法也可以把普通函数转化为<code>curry function</code>，具体的<code>curry</code>的实现后边有</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//比如我要使用filter筛选出有橡胶果实的男主角.</span>
<span class="token comment">//先用古老方法</span>
<span class="token keyword">var</span> onePiece <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> hero<span class="token punctuation">:</span><span class="token string">'路飞'</span><span class="token punctuation">,</span> fruit<span class="token punctuation">:</span><span class="token string">'橡胶果实'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> hero<span class="token punctuation">:</span><span class="token string">'卡塔庫栗'</span><span class="token punctuation">,</span> fruit<span class="token punctuation">:</span><span class="token string">'糯糯果实'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> hero<span class="token punctuation">:</span><span class="token string">'big mom'</span><span class="token punctuation">,</span> fruit<span class="token punctuation">:</span><span class="token string">'魂魂果实'</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">let</span> <span class="token function-variable function">hasFruit</span> <span class="token operator">=</span> <span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> obj<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>fruit <span class="token operator">===</span> fruit<span class="token punctuation">;</span>
<span class="token keyword">const</span> hero <span class="token operator">=</span> onePiece<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> <span class="token function">hasFruit</span><span class="token punctuation">(</span><span class="token string">'橡胶果实'</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//再使用lodash使hasFruit柯里化</span>
<span class="token keyword">import</span> <span class="token string">'_'</span> <span class="token keyword">from</span> <span class="token string">'lodash'</span>
<span class="token keyword">const</span> hasFruitCurry <span class="token operator">=</span>  _<span class="token punctuation">.</span><span class="token function">curry</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fruit<span class="token punctuation">,</span> obj<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">.</span>fruit <span class="token operator">===</span> fruit<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> heroCurry <span class="token operator">=</span> onePiece<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">hasFruitCurry</span><span class="token punctuation">(</span><span class="token string">'橡胶果实'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>在vue中有个最常用的例子，是<code>code split</code>里的异步组件的引入路径的代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">AsyncMultComp</span> <span class="token operator">=</span> dir <span class="token operator">=&gt;</span> component <span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  component<span class="token punctuation">:</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`../components/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>component<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.vue`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  delay<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  timeout<span class="token punctuation">:</span> <span class="token number">3000</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//这样就固化了dir这个参数 比如用起来可以这样:</span>
<span class="token keyword">const</span> curriedComp <span class="token operator">=</span> <span class="token function">AsyncMultComp</span><span class="token punctuation">(</span><span class="token string">'admin/user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//然后参数复用,爽</span>
<span class="token keyword">const</span> com <span class="token operator">=</span> <span class="token function">curriedComp</span><span class="token punctuation">(</span><span class="token string">'OrderList'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="pipe和compose"><a href="#pipe和compose" aria-hidden="true" class="header-anchor">#</a> pipe和compose</h2> <p><code>pipe</code>和<code>compose</code>其实就是参数是相反的方向,先来看一下这段代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token punctuation">(</span>person<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> person<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">uppercase</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> string<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">get6Characters</span> <span class="token operator">=</span> string <span class="token operator">=&gt;</span> string<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">reverse</span> <span class="token operator">=</span> string <span class="token operator">=&gt;</span> string<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token function">get6Characters</span><span class="token punctuation">(</span><span class="token function">uppercase</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Nicolas_Cage'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//这个就是所谓的pipeline,前一个函数的输出是后一个函数的输入</span>
</code></pre></div><p>用reduce改写一下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">pipe</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>fns<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj <span class="token operator">=&gt;</span> fns<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">g</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">pipe</span><span class="token punctuation">(</span>getName<span class="token punctuation">,</span> uppercase<span class="token punctuation">,</span> get6Characters<span class="token punctuation">,</span> reverse<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Nicolas_Cage'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//ALOCIN</span>
</code></pre></div><p>以上是<code>pipe</code>, <code>compose</code>其实和<code>pipe</code>一样，只是参数的方向反了</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//利用了reduceRight即可</span>
<span class="token keyword">const</span> <span class="token function-variable function">compose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>fns<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj <span class="token operator">=&gt;</span> fns<span class="token punctuation">.</span><span class="token function">reduceRight</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">g</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">compose</span><span class="token punctuation">(</span>reverse<span class="token punctuation">,</span> get6Characters<span class="token punctuation">,</span> uppercase<span class="token punctuation">,</span> getName<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'Nicolas_Cage'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//ALOCIN</span>
<span class="token comment">//也可以使用args的reverse</span>
<span class="token keyword">const</span> <span class="token function-variable function">compose</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>fns<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>pipe<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>pipe<span class="token punctuation">,</span> fns<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//以上都是一元参数，多个参数可以这么写</span>
<span class="token keyword">const</span> <span class="token function">compose</span> <span class="token punctuation">(</span><span class="token operator">...</span>fns<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fns<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>慢慢学函数式编程吧。</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">9/10/2018, 10:39:16 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/nicolas_blog/blogs/issues.html" class="prev">
          遇到过的Issue
        </a></span> <span class="next"><a href="/nicolas_blog/blogs/safe_access.html">
          前端中的Robust
        </a>
        →
      </span></p></div> <div class="bsa-cpc-wrapper"><div class="bsa-cpc"></div></div></div> <!----></div></div>
    <script src="/nicolas_blog/assets/js/9.6edef93c.js" defer></script><script src="/nicolas_blog/assets/js/app.8757db7b.js" defer></script>
  </body>
</html>
